TARGET DECK
A Tour of C++::06 - Essential Operations

# Essential Operations <!--fc-->
Constructors, destructors, copy, and move operations for a type are not logically separate. We must define them as a matched set or suffer logical or performance problems
![[Pasted image 20240614143059.png]]
For example, there are five situations in which an object can be copied or moved
- Source of an assignment
- Object initializer
- Function argument
- Function return value
- As an exception
<!--ID: 1718397755633-->


## Default special functions <!--fc-->
Essential operations will be generated by the compiler by default. If you want to be explicit, you can do this
![[Pasted image 20240614143422.png]]
<!--ID: 1718397755637-->


## Copy and move in classes with pointer members <!--fc-->
If a class has a pointer member, you may want to be explicit about copy and move operations. The pointer may point to something which the class needs to `delete`, which the default copy may not do correctly.
<!--ID: 1718397755641-->


## Rule of zero <!--fc-->
Either define all essential operations, or none (using the default for all) for readability purposes
![[Pasted image 20240614143813.png]]
Here, the compiler will synthesize memberwise default construction, copy, move, and destruction as needed
<!--ID: 1718397755645-->


## `=delete` <!--fc-->
To complement `=default`, you can use `=delete` to ensure that an operation is not to be generated.
A good example of this is a base class, which we usually don't want memberwise copying to be defined
![[Pasted image 20240614144024.png]]
<!--ID: 1718397755650-->

# Conversions <!--fc-->
A constructor taking a single argument defines a conversion form its argument type. 
For example, `complex` provides a constructor from a `double`:
```C++
complex z1 = 3.14; // z1 becomes {3.14,0.0}
complex z2 = z1âˆ—2; // z2 becomes z1*{2.0,0} == {6.28,0.0}
```

## Explicit conversion <!--fc-->
Implicit conversion is not always ideal, for example
```C++
Vector v1 = 7; //v1 has 7 elements
```
This can be sort of confusing, so we can make it so only explicit conversion is allowed
```C++
class Vector {
public:
	explicit Vector(int s) //no implicit conversion allowed
}
```
This gives us
```C++
Vector v1(7); //Ok
Vector v2 = 7; //ERROR
```


# Member Initializers